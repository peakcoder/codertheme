function buildPostMenutree(){var t=jQuery(".post-body").find("h1,h2,h3,h4,h5,h6");if(!(t.length<2)){var e="";e+='<div class="post-menutree-wrapper" >',e+='<div class="post-menutree-title"><span class="post-menutree-title-name">内容目录</span><span class="post-menutree-title-handle">[<a href="#" onclick="javascript:return openPostMenutree(this);" title="显示">显示</a>]</span></div>',e+='<div class="post-menutree-content">',e+='<ol class="post-menutree-content-list">';for(var i=0,o=0,n=0;n<t.length;n++){var s=parseInt(t[n].tagName.substr(1),10);if(i||(i=s),s>i?(e+="<ol>",o++):s<i&&o>0&&(e+="</ol>",o--),1==s)for(;o>0;)e+="</ol>",o--;i=s;var r=t.eq(n).text();r.length<100&&(e+='<li><a href="javascript:void(0);" onclick="menuScrollTo(\'#menu_t'+n+"')\">"+r+"</a></li>",t.eq(n).html('<a id="menu_t'+n+'"></a>'+t.eq(n).html()))}for(;o>0;)e+="</ol>",o--;e+="</ol></div>",e+="</div><div style='clear:both'></div>",jQuery(e).insertAfter(jQuery(".post-menutree-wrapper-before"))}}function menuScrollTo(t){$("html,body").animate({scrollTop:$(t).offset().top-20},500)}function openPostMenutree(t){return"显示"==t.innerHTML?(jQuery(t).attr("title","隐藏").html("隐藏"),jQuery(".post-menutree-content").slideDown("fast")):(jQuery(t).attr("title","显示").html("显示"),jQuery(".post-menutree-content").slideUp("fast")),t.blur(),!1}$(document).ready(function(){function t(t){this.el=$(t.el),this.status=$.extend({},{init:{width:"100%",opacity:1,left:0,rotateZ:0,top:0}},t.status)}NexT.motion={};var e={lines:[],push:function(t){this.lines.push(t)},init:function(){this.lines.forEach(function(t){t.init()})},arrow:function(){this.lines.forEach(function(t){t.arrow()})},close:function(){this.lines.forEach(function(t){t.close()})}};t.prototype.init=function(){this.transform("init")},t.prototype.arrow=function(){this.transform("arrow")},t.prototype.close=function(){this.transform("close")},t.prototype.transform=function(t){this.el.velocity("stop").velocity(this.status[t])};var i=new t({el:".sidebar-toggle-line-first",status:{arrow:{width:"50%",rotateZ:"-45deg",top:"2px"},close:{width:"100%",rotateZ:"-45deg",top:"5px"}}}),o=new t({el:".sidebar-toggle-line-middle",status:{arrow:{width:"90%"},close:{opacity:0}}}),n=new t({el:".sidebar-toggle-line-last",status:{arrow:{width:"50%",rotateZ:"45deg",top:"-2px"},close:{width:"100%",rotateZ:"45deg",top:"-5px"}}});e.push(i),e.push(o),e.push(n);({toggleEl:$(".sidebar-toggle"),sidebarEl:$(".sidebar"),isSidebarVisible:!1,init:function(){this.toggleEl.on("click",this.clickHandler.bind(this)),this.toggleEl.on("mouseenter",this.mouseEnterHandler.bind(this)),this.toggleEl.on("mouseleave",this.mouseLeaveHandler.bind(this)),$(document).on("sidebar.isShowing",function(){NexT.utils.isDesktop()&&$("body").velocity("stop").velocity({paddingRight:"320px"},150)}).on("sidebar.isHiding",function(){})},clickHandler:function(){this.isSidebarVisible?this.hideSidebar():this.showSidebar(),this.isSidebarVisible=!this.isSidebarVisible},mouseEnterHandler:function(){this.isSidebarVisible||e.arrow()},mouseLeaveHandler:function(){this.isSidebarVisible||e.init()},showSidebar:function(){var t=this;e.close(),this.sidebarEl.velocity("stop").velocity({width:"320px"},{display:"block",duration:150,begin:function(){$(".sidebar .motion-element").velocity("transition.slideRightIn",{stagger:20,drag:!0,complete:function(){t.sidebarEl.trigger("sidebar.motion.complete")}})},complete:function(){t.sidebarEl.addClass("sidebar-active"),t.sidebarEl.trigger("sidebar.didShow")}}),this.sidebarEl.trigger("sidebar.isShowing")},hideSidebar:function(){NexT.utils.isDesktop()&&$("body").velocity("stop").velocity({paddingRight:0}),this.sidebarEl.find(".motion-element").velocity("stop").css("display","none"),this.sidebarEl.velocity("stop").velocity({width:0},{display:"none"}),e.init(),this.sidebarEl.removeClass("sidebar-active"),this.sidebarEl.trigger("sidebar.isHiding"),$(".post-toc-wrap")&&"block"===$(".site-overview").css("display")&&$(".post-toc-wrap").removeClass("motion-element")}}).init(),NexT.motion.integrator={queue:[],cursor:-1,add:function(t){return this.queue.push(t),this},next:function(){this.cursor++;var t=this.queue[this.cursor];$.isFunction(t)&&t(NexT.motion.integrator)},bootstrap:function(){this.next()}},NexT.motion.middleWares={logo:function(t){function e(t,e){return{e:$(t),p:{translateX:e},o:{duration:300,sequenceQueue:!1}}}function i(t){return t=Array.isArray(t)?t:[t],t.every(function(t){return $.isFunction(t.size)&&t.size()>0})}var o=[],n=$(".brand"),s=$(".site-title"),r=$(".site-subtitle"),a=$(".logo-line-before i"),l=$(".logo-line-after i");n.size()>0&&o.push({e:n,p:{opacity:1},o:{duration:150}}),NexT.utils.isMist()&&i([a,l])&&o.push(e(a,"100%"),e(l,"-100%")),i(s)&&o.push({e:s,p:{opacity:1,top:0},o:{duration:150}}),i(r)&&o.push({e:r,p:{opacity:1,top:0},o:{duration:150}}),o.length>0?(o[o.length-1].o.complete=function(){t.next()},$.Velocity.RunSequence(o)):t.next()},menu:function(t){$(".menu-item").velocity("transition.slideDownIn",{display:null,duration:200,complete:function(){t.next()}})},postList:function(t){var e=$(".post");e.size()>0?function(){var i=window.postMotionOptions||{stagger:10,drag:!0};i.complete=function(){t.next()},e.velocity("transition.slideDownIn",i)}():t.next()},sidebar:function(t){"always"===CONFIG.sidebar&&NexT.utils.displaySidebar(),t.next()}}}),NexT.utils=NexT.$u={wrapImageWithFancyBox:function(){$(".post-body img").not(".group-picture img").each(function(){var t=$(this),e=t.attr("title"),i=t.parent("a");i.size()<1||(i.addClass("fancybox"),i.attr("rel","group"),e&&(i.append('<p class="image-caption">'+e+"</p>"),i.attr("title",e)))}),$(".fancybox").fancybox({padding:5,margin:15,autoSize:!0,autoResize:!0,fitToView:!1,aspectRatio:!0,maxWidth:"100%",helpers:{overlay:{locked:!1}}})},embeddedVideoTransformer:function(){var t=$("iframe"),e=["www.youtube.com","player.vimeo.com","player.youku.com","music.163.com","www.tudou.com"],i=new RegExp(e.join("|"));t.each(function(){var t=this,e=$(this);if(this.src.search(i)>0){var o=e.height()/e.width()*100;this.src.search("music.163.com")>0&&(o+=10),e.width("100%").height("100%").css({position:"absolute",top:"0",left:"0"});var n=document.createElement("div");n.className="fluid-vids",n.style.width="100%",n.style.position="relative",n.style.paddingTop=o+"%";t.parentNode.insertBefore(n,t),n.appendChild(t)}})},addActiveClassToMenuItem:function(){var t=window.location.href;$('.menu-item a[href="'+t+'"]').parent().addClass("menu-item-active")},hasMobileUA:function(){return/iPad|iPhone|Android|Opera Mini|BlackBerry|webOS|UCWEB|Blazer|PSP|IEMobile|Symbian/g.test(window.navigator.userAgent)},isTablet:function(){return window.screen.width<992&&window.screen.width>767&&this.hasMobileUA()},isMobile:function(){return window.screen.width<767&&this.hasMobileUA()},isDesktop:function(){return!this.isTablet()&&!this.isMobile()},escapeSelector:function(t){return t.replace(/[!"$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")},displaySidebar:function(){this.isDesktop()&&$(".sidebar-toggle").trigger("click")},isMist:function(){return"Mist"===CONFIG.scheme},isPisces:function(){return"Pisces"===CONFIG.scheme},isGemini:function(){return"Gemini"===CONFIG.scheme}},$(document).ready(function(){$(document).trigger("bootstrap:before"),NexT.utils.isMobile()&&window.FastClick.attach(document.body),$("#posts").find("img").lazyload({placeholder:"/images/loading.gif",effect:"fadeIn"}),$(".back-to-top").on("click",function(){$("body").velocity("scroll")}),$(".site-nav-toggle button").on("click",function(){var t=$(".site-nav"),e=t.hasClass("site-nav-on"),i=e?"slideUp":"slideDown",o=e?"removeClass":"addClass";t.stop()[i]("fast",function(){t[o]("site-nav-on")})}),CONFIG.fancybox&&NexT.utils.wrapImageWithFancyBox(),NexT.utils.embeddedVideoTransformer(),NexT.utils.addActiveClassToMenuItem(),NexT.motion.integrator.add(NexT.motion.middleWares.logo).add(NexT.motion.middleWares.menu).add(NexT.motion.middleWares.postList).add(NexT.motion.middleWares.sidebar),$(document).trigger("motion:before"),CONFIG.motion&&NexT.motion.integrator.bootstrap(),$(document).trigger("bootstrap:after")}),function(t){"use strict";function e(e){return this.each(function(){var o=t(this),n=o.data("bs.affix"),s="object"==typeof e&&e;n||o.data("bs.affix",n=new i(this,s)),"string"==typeof e&&n[e]()})}var i=function(e,o){this.options=t.extend({},i.DEFAULTS,o),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.3.5",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getState=function(t,e,i,o){var n=this.$target.scrollTop(),s=this.$element.offset(),r=this.$target.height();if(null!=i&&"top"==this.affixed)return n<i&&"top";if("bottom"==this.affixed)return null!=i?!(n+this.unpin<=s.top)&&"bottom":!(n+r<=t-o)&&"bottom";var a=null==this.affixed,l=a?n:s.top,c=a?r:e;return null!=i&&n<=i?"top":null!=o&&l+c>=t-o&&"bottom"},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},i.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),o=this.options.offset,n=o.top,s=o.bottom,r=Math.max(t(document).height(),t(document.body).height());"object"!=typeof o&&(s=n=o),"function"==typeof n&&(n=o.top(this.$element)),"function"==typeof s&&(s=o.bottom(this.$element));var a=this.getState(r,e,n,s);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var l="affix"+(a?"-"+a:""),c=t.Event(l+".bs.affix");if(this.$element.trigger(c),c.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:r-e-s})}};var o=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=i,t.fn.affix.noConflict=function(){return t.fn.affix=o,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var i=t(this),o=i.data();o.offset=o.offset||{},null!=o.offsetBottom&&(o.offset.bottom=o.offsetBottom),null!=o.offsetTop&&(o.offset.top=o.offsetTop),e.call(i,o)})})}(jQuery),$(document).ready(function(){$(window).width()>=1095&&$(".right-layer").css("left",$(".content-wrap").offset().left+$(".content-wrap").outerWidth()+5+"px"),$(window).scrollTop()>50&&$(".site-back-to-top").show(),$(window).resize(function(){$(window).width()>=1095?$(".right-layer").css("left",$(".content-wrap").offset().left+$(".content-wrap").outerWidth()+5+"px"):$(".right-layer").css("left","inherit").css("right","10px")}),$(window).scroll(function(){$(window).width()>=1095?$(".right-layer").css("left",$(".content-wrap").offset().left+$(".content-wrap").outerWidth()+5+"px"):$(".right-layer").css("right","10px"),$(window).scrollTop()>50?$(".site-back-to-top").fadeIn(200):$(".site-back-to-top").fadeOut(200)}),$(".site-back-to-top").click(function(){return $("body,html").animate({scrollTop:0},300),!1}),$(".site-qrcode-btn").hover(function(){$(".site-qrcode-img").css("left",$(".right-layer").offset().left-$(".site-qrcode-img").outerWidth()+"px"),$(".site-qrcode-img").css("bottom",parseInt($(".right-layer").css("bottom"))+"px"),$(".site-qrcode-img").show()},function(){$(".site-qrcode-img").hide()})}),$(document).ready(function(){var t=$("#sidebar");$(".header-inner").height(),parseInt($(".main").css("padding-bottom"),10);t.show()});var $menu=$("#menu"),$menuItemSearch=$menu.find(".menu-item-search"),$siteSearch=$menu.find(".site-search");$menuItemSearch.click(function(){return $siteSearch.show(200),!1}),$menuItemSearch.on("mouseleave",function(){$siteSearch.hide(300)});